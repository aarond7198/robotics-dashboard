<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API Debug Test</title>
  <script>
    console.log("🧪 Script loaded...");

    const CLIENT_ID = "714659777422-2sal3s5etmbins8qqull5019mn9e7tnl.apps.googleusercontent.com";
    const SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";
    const SHEET_ID = "1tlG9DzmSRHmPu8Qo4Xd6TFStIhbeM4dTsFb7OvycR3M";

    let tokenClient;

function loadSheet() {
  console.log("📥 Attempting to fetch Google Sheet...");
  gapi.client.sheets.spreadsheets.values.get({
    spreadsheetId: SHEET_ID,
    range: "Sheet1"
  }).then(response => {
    console.log("✅ Raw response object:", response);
    const data = response.result?.values;
    if (data && data.length) {
      console.log("📊 Sheet rows:", data);
      alert(`✅ Loaded ${data.length - 1} rows.`);
    } else {
      console.warn("⚠️ Sheet returned no values.");
      alert("⚠️ Sheet is connected but contains no visible data.");
    }
  }).catch(error => {
    console.error("❌ Error loading sheet:", error);
    alert("❌ Error loading sheet. Check console.");
  });
}


    function init() {
      console.log("🚀 gapi loaded, initializing...");
      gapi.load("client", async () => {
        await gapi.client.init({});
        console.log("✅ gapi client initialized");

        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id: CLIENT_ID,
          scope: SCOPES,
          callback: (tokenResponse) => {
            console.log("🔐 Token received:", tokenResponse);
            loadSheet();
          }
        });

        document.getElementById("loginBtn").disabled = false;
      });
    }

    function requestAccess() {
      console.log("🔓 Requesting access token...");
      tokenClient.requestAccessToken();
    }
  </script>
  <script src="https://apis.google.com/js/api.js" onload="init()"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h1>🔍 Sheets API Debug Test</h1>
  <p>If you see nothing in the console, the scripts aren't running!</p>
  <button id="loginBtn" onclick="requestAccess()" disabled>🔐 Login and Load Sheet</button>

  <style>
    body { font-family: sans-serif; padding: 40px; }
    button { font-size: 1.2rem; padding: 10px 20px; }
  </style>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API Test v1.0</title>
  <script>
    const CLIENT_ID = "714659777422-2sal3s5etmbins8qqull5019mn9e7tnl.apps.googleusercontent.com";
    const SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";
    const SHEET_ID = "1tlG9DzmSRHmPu8Qo4Xd6TFStIhbeM4dTsFb7OvycR3M";

    let tokenClient;

    function loadSheet() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SHEET_ID,
        range: "Sheet1"
      }).then(response => {
        console.log("✅ Success:", response.result.values);
        alert("✅ Sheet data loaded — check the console!");
      }).catch(error => {
        console.error("❌ Failed to load sheet:", error);
        alert("❌ Error loading sheet. See console.");
      });
    }

    function init() {
      gapi.load("client", async () => {
        await gapi.client.init({});
        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id: CLIENT_ID,
          scope: SCOPES,
          prompt: 'consent',
          callback: () => loadSheet()
        });
        document.getElementById("loginBtn").disabled = false;
      });
    }

    function requestAccess() {
      tokenClient.requestAccessToken();
    }
  </script>
  <script src="https://apis.google.com/js/api.js" onload="init()"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h1>🧪 Google Sheets API Test</h1>
  <p>Click the button below to test reading your sheet.</p>
  <button id="loginBtn" onclick="requestAccess()" disabled>🔐 Login and Load Sheet</button>

  <style>
    body { font-family: sans-serif; padding: 40px; }
    button { font-size: 1.2rem; padding: 10px 20px; }
  </style>
</body>
</html>
